# ðŸ“‹ ë„ìž¥ ì´ë¯¸ì§€ ì¡°ê±´ë¶€ ë…¸ì¶œ ê¸°ëŠ¥ ê°œë°œ ì™„ë£Œ

## ðŸŽ¯ ê°œë°œ ê°œìš”

ë™ì  ì²­êµ¬ì„œ í…œí”Œë¦¿ ìƒì„± ì‹œìŠ¤í…œì—ì„œ **ì¸ê°ë‚ ì¸ ì‚¬ìš©ì—¬ë¶€(stamp_yn)** í•„ë“œê°’ì— ë”°ë¼ ì—‘ì…€ í…œí”Œë¦¿ì˜ ë„ìž¥ ì´ë¯¸ì§€ë¥¼ ì¡°ê±´ë¶€ë¡œ ë…¸ì¶œí•˜ëŠ” ê¸°ëŠ¥ì„ ê°œë°œí–ˆìŠµë‹ˆë‹¤.

## ðŸ”§ í•µì‹¬ ê¸°ëŠ¥

### 1. ì¡°ê±´ë¶€ ë„ìž¥ ì´ë¯¸ì§€ ì²˜ë¦¬
- **stamp_yn = 'Y'**: ë„ìž¥ ì´ë¯¸ì§€ ìœ ì§€ (ì •ìƒ í‘œì‹œ)
- **stamp_yn = 'N'**: ë„ìž¥ ì´ë¯¸ì§€ ì œê±°/ìˆ¨ê¹€ ì²˜ë¦¬

### 2. ì§€ëŠ¥í˜• ë„ìž¥ ì´ë¯¸ì§€ ì‹ë³„
- **ìœ„ì¹˜ ê¸°ë°˜ íŒë‹¨**: 4ê°œ ì˜ì—­(ìš°ìƒë‹¨, ìš°í•˜ë‹¨, ì¤‘ì•™ìš°ì¸¡, ì¢Œìƒë‹¨)ì—ì„œ ë„ìž¥ ì´ë¯¸ì§€ íƒì§€
- **í¬ê¸° ê¸°ë°˜ íŒë‹¨**: ìž‘ì€ ë„ìž¥(1x1~4x4), ì¤‘ê°„ ë„ìž¥(3x3~8x8), í° ë„ìž¥(6x6~12x12) ë²”ìœ„ ì§€ì›
- **íŒŒì¼ í˜•ì‹ ê²€ì¦**: PNG, JPG, JPEG, GIF, BMP, TIFF ì´ë¯¸ì§€ íŒŒì¼ë§Œ ëŒ€ìƒ

### 3. ì„¤ì • ê¸°ë°˜ ì œì–´
```properties
# ë„ìž¥ ì´ë¯¸ì§€ ì²˜ë¦¬ ì„¤ì •
app.excel.stamp.enabled=true          # ë„ìž¥ ì²˜ë¦¬ í™œì„±í™”/ë¹„í™œì„±í™”
app.excel.stamp.debug=true            # ë””ë²„ê·¸ ë¡œê¹… í™œì„±í™”
app.excel.stamp.region.enabled=true   # ì˜ì—­ ê¸°ë°˜ íŒë‹¨ í™œì„±í™”
```

## ðŸ“ ìˆ˜ì •ëœ íŒŒì¼ë“¤

### 1. ExcelTemplateService.java
```java
// ìƒˆë¡œ ì¶”ê°€ëœ ì£¼ìš” ë©”ì„œë“œë“¤
- processStampImage()           // ë„ìž¥ ì´ë¯¸ì§€ ì¡°ê±´ë¶€ ì²˜ë¦¬
- removeStampImages()          // ë„ìž¥ ì´ë¯¸ì§€ ì œê±°
- isStampImage()              // ë„ìž¥ ì´ë¯¸ì§€ ì‹ë³„
- isInStampRegion()           // ë„ìž¥ ì˜ì—­ íŒë‹¨
- isStampSizeRange()          // ë„ìž¥ í¬ê¸° íŒë‹¨
- removePicture()             // ì´ë¯¸ì§€ ìˆ¨ê¹€ ì²˜ë¦¬
```

### 2. TmplService.java
```java
// ë¡œê¹… ê°œì„ 
- ì¸ê°ë‚ ì¸ ì‚¬ìš©ì—¬ë¶€ ë¡œê¹… ì¶”ê°€
- í…œí”Œë¦¿ ìƒì„± ê³¼ì • ì¶”ì  ê°•í™”
```

### 3. TemplateController.java (ì‹ ê·œ ìƒì„±)
```java
// API ì—”ë“œí¬ì¸íŠ¸
POST /api/template/generate/{businessNo}     // íŠ¹ì • ì‚¬ì—…ìž í…œí”Œë¦¿ ìƒì„±
POST /api/template/generate-all              // ì „ì²´ í…œí”Œë¦¿ ìƒì„±
GET  /api/template/check/{businessNo}        // ì‚¬ì—…ìž ì¡´ìž¬ í™•ì¸
```

### 4. application.properties
```properties
# ë„ìž¥ ì´ë¯¸ì§€ ì²˜ë¦¬ ê´€ë ¨ ì„¤ì • ì¶”ê°€
app.excel.stamp.enabled=true
app.excel.stamp.debug=true
app.excel.stamp.region.enabled=true
```

## ðŸš€ ì‚¬ìš© ë°©ë²•

### 1. APIë¥¼ í†µí•œ í…ŒìŠ¤íŠ¸
```bash
# íŠ¹ì • ì‚¬ì—…ìž í…œí”Œë¦¿ ìƒì„± (ë„ìž¥ ì´ë¯¸ì§€ ì¡°ê±´ë¶€ ì²˜ë¦¬)
curl -X POST http://localhost:8080/api/template/generate/123-45-67890

# ì‚¬ì—…ìž ì¡´ìž¬ ì—¬ë¶€ í™•ì¸
curl -X GET http://localhost:8080/api/template/check/123-45-67890

# ì „ì²´ ì‚¬ì—…ìž í…œí”Œë¦¿ ìƒì„±
curl -X POST http://localhost:8080/api/template/generate-all
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • í™•ì¸
```sql
-- BBIMCM_INVT í…Œì´ë¸”ì—ì„œ ì¸ê°ë‚ ì¸ ì„¤ì • í™•ì¸
SELECT busi_mgmt_id, stamp_yn FROM BBIMCM_INVT WHERE del_yn = 'N';

-- stamp_yn ê°’ ë³€ê²½ í…ŒìŠ¤íŠ¸
UPDATE BBIMCM_INVT SET stamp_yn = 'N' WHERE busi_mgmt_id = 1;  -- ë„ìž¥ ìˆ¨ê¹€
UPDATE BBIMCM_INVT SET stamp_yn = 'Y' WHERE busi_mgmt_id = 1;  -- ë„ìž¥ í‘œì‹œ
```

## ðŸ” ë¡œê·¸ ëª¨ë‹ˆí„°ë§

### 1. ë„ìž¥ ì²˜ë¦¬ ë¡œê·¸ ì˜ˆì‹œ
```
INFO  - ì¸ê°ë‚ ì¸ ì‚¬ìš©ì—¬ë¶€: Y (í‘œì‹œ)
INFO  - ë„ìž¥ ì´ë¯¸ì§€ ì¡°ê±´ë¶€ ì²˜ë¦¬ ì‹œìž‘ - ì‚¬ì—…ìžë²ˆí˜¸: 123-45-67890, ì¸ê°ë‚ ì¸ ì‚¬ìš©ì—¬ë¶€: Y
INFO  - ë„ìž¥ ì´ë¯¸ì§€ ìœ ì§€ - ì‚¬ì—…ìžë²ˆí˜¸: 123-45-67890 (ì¸ê°ë‚ ì¸ ì‚¬ìš©)
INFO  - í…œí”Œë¦¿ ìƒì„± ì²˜ë¦¬ ì™„ë£Œ - ì‚¬ì—…ìžë²ˆí˜¸: 123-45-67890 (ì¸ê°ë‚ ì¸: Y)
```

### 2. ë””ë²„ê·¸ ë¡œê·¸ ì˜ˆì‹œ (stamp.debug=true)
```
DEBUG - ì´ë¯¸ì§€ ìœ„ì¹˜ ë° í¬ê¸° í™•ì¸ - ìœ„ì¹˜: (28,8) ~ (32,12), í¬ê¸°: 4x4, ë„ìž¥ì˜ì—­: true, ë„ìž¥í¬ê¸°: true, íŒŒì¼í˜•ì‹: png
DEBUG - ë„ìž¥ ì´ë¯¸ì§€ë¡œ íŒë‹¨ë¨ - ì˜ì—­ë§¤ì¹˜: true, í¬ê¸°ë§¤ì¹˜: true
DEBUG - ë„ìž¥ ì´ë¯¸ì§€ ì œê±°: png
```

## âš™ï¸ ê³ ê¸‰ ì„¤ì •

### 1. ë„ìž¥ ì˜ì—­ ì»¤ìŠ¤í„°ë§ˆì´ì§•
`ExcelTemplateService.java`ì˜ `isInStampRegion()` ë©”ì„œë“œì—ì„œ ë„ìž¥ ìœ„ì¹˜ ì˜ì—­ì„ ì¡°ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

```java
// ì˜ì—­ 1: ìš°ìƒë‹¨ (ì¼ë°˜ì ì¸ ë„ìž¥ ìœ„ì¹˜)
boolean region1 = (col1 >= 20 && col1 <= 40) && (row1 >= 0 && row1 <= 20);
```

### 2. ë„ìž¥ í¬ê¸° ë²”ìœ„ ì¡°ì •
`isStampSizeRange()` ë©”ì„œë“œì—ì„œ ë„ìž¥ í¬ê¸° ë²”ìœ„ë¥¼ ì¡°ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

```java
// ìž‘ì€ ë„ìž¥: 1x1 ~ 4x4
boolean smallStamp = (width >= 1 && width <= 4) && (height >= 1 && height <= 4);
```

### 3. ì²˜ë¦¬ ë°©ì‹ ë³€ê²½
í˜„ìž¬ëŠ” ì´ë¯¸ì§€ë¥¼ í™”ë©´ ë°–ìœ¼ë¡œ ì´ë™ì‹œì¼œ ìˆ¨ê¹€ ì²˜ë¦¬í•˜ì§€ë§Œ, í•„ìš”ì— ë”°ë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥:
- ì´ë¯¸ì§€ ì™„ì „ ì‚­ì œ
- íˆ¬ëª…ë„ ì¡°ì •
- í¬ê¸°ë¥¼ 0ìœ¼ë¡œ ë³€ê²½

## ðŸŽ¯ ë™ìž‘ ì›ë¦¬

### 1. í…œí”Œë¦¿ ìƒì„± í”Œë¡œìš°
```
TmplService.generateTemplateByBusinessNo()
    â†“
ExcelTemplateService.generateExcelTemplate()
    â†“
processStampImage() â†’ stamp_yn í™•ì¸
    â†“
stamp_yn = 'N' ? removeStampImages() : ì´ë¯¸ì§€ ìœ ì§€
    â†“
isStampImage() â†’ ìœ„ì¹˜/í¬ê¸°/í˜•ì‹ ê¸°ë°˜ ë„ìž¥ ì‹ë³„
    â†“
removePicture() â†’ í™”ë©´ ë°–ìœ¼ë¡œ ì´ë™í•˜ì—¬ ìˆ¨ê¹€
```

### 2. ë„ìž¥ ì‹ë³„ ì•Œê³ ë¦¬ì¦˜
```
1. íŒŒì¼ í™•ìž¥ìž ê²€ì¦ (ì´ë¯¸ì§€ íŒŒì¼ì¸ê°€?)
    â†“
2. ìœ„ì¹˜ ì˜ì—­ í™•ì¸ (4ê°œ ë„ìž¥ ê°€ëŠ¥ ì˜ì—­)
    â†“
3. í¬ê¸° ë²”ìœ„ í™•ì¸ (3ê°œ ë„ìž¥ í¬ê¸° ë²”ìœ„)
    â†“
4. OR ì¡°ê±´ íŒë‹¨ (ìœ„ì¹˜ OR í¬ê¸° ì¤‘ í•˜ë‚˜ë¼ë„ ë§Œì¡±)
    â†“
5. ë„ìž¥ ì´ë¯¸ì§€ë¡œ íŒë‹¨ ì‹œ ìˆ¨ê¹€ ì²˜ë¦¬
```

## âœ… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] stamp_yn = 'Y'ì¸ ì‚¬ì—…ìžì˜ í…œí”Œë¦¿ì—ì„œ ë„ìž¥ ì´ë¯¸ì§€ ì •ìƒ í‘œì‹œ
- [ ] stamp_yn = 'N'ì¸ ì‚¬ì—…ìžì˜ í…œí”Œë¦¿ì—ì„œ ë„ìž¥ ì´ë¯¸ì§€ ìˆ¨ê¹€ ì²˜ë¦¬
- [ ] ì—¬ëŸ¬ ë„ìž¥ì´ ìžˆëŠ” ê²½ìš° ëª¨ë‘ ì¡°ê±´ë¶€ ì²˜ë¦¬
- [ ] ì¼ë°˜ ì´ë¯¸ì§€ëŠ” ë„ìž¥ìœ¼ë¡œ ì˜¤ì¸ì‹í•˜ì§€ ì•ŠìŒ
- [ ] ë¡œê·¸ë¥¼ í†µí•œ ì²˜ë¦¬ ê³¼ì • ì¶”ì  ê°€ëŠ¥
- [ ] ì„¤ì •ì„ í†µí•œ ê¸°ëŠ¥ í™œì„±í™”/ë¹„í™œì„±í™” ê°€ëŠ¥

## ðŸš¨ ì£¼ì˜ì‚¬í•­

1. **ë°±ì—… í•„ìˆ˜**: ì›ë³¸ ì—‘ì…€ í…œí”Œë¦¿ íŒŒì¼ì€ í•­ìƒ ë°±ì—… ë³´ê´€
2. **í…ŒìŠ¤íŠ¸ í™˜ê²½**: í”„ë¡œë•ì…˜ ì ìš© ì „ ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ í•„ìš”
3. **ì˜ì—­ ì¡°ì •**: ì‹¤ì œ í…œí”Œë¦¿ì˜ ë„ìž¥ ìœ„ì¹˜ì— ë§žê²Œ ì˜ì—­ ë²”ìœ„ ì¡°ì • í•„ìš”
4. **ì„±ëŠ¥ ê³ ë ¤**: ëŒ€ëŸ‰ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

## ðŸ“ž ë¬¸ì˜ ë° ì§€ì›

ë„ìž¥ ì´ë¯¸ì§€ ê¸°ëŠ¥ê³¼ ê´€ë ¨í•˜ì—¬ ë¬¸ì˜ì‚¬í•­ì´ ìžˆìœ¼ì‹œë©´ ê°œë°œíŒ€ì— ì—°ë½í•´ì£¼ì„¸ìš”.

---
**ê°œë°œ ì™„ë£Œì¼**: 2024ë…„ 12ì›” 27ì¼  
**ê°œë°œìž**: ì‹œë‹ˆì–´ í’€ìŠ¤íƒ ê°œë°œìž  
**ë²„ì „**: v1.0.0 